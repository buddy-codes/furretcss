{"version":3,"sources":["furretcss/js/theme-toggle.js"],"names":["_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","err","normalCompletion","didErr","call","step","next","_e2","minLen","_arrayLikeToArray","Object","prototype","toString","slice","constructor","name","from","test","arr","len","arr2","window","furrets","USER_OVERRIDE","acceptedHostnames","DOMRegex","elem","attr","regex","_step","output","_iterator","document","querySelectorAll","link","url","includes","location","hostname","URL","origin","pathname","push","loadColorScheme","scheme","_step2","furretcssPath","RegExp","_iterator2","href","rel","min","concat","protocol","localStorage","getItem","matchMedia","matches","setItem","themeToggle","toggleBtn","themeToSet","innerText","addThemeToggle","storedTheme","createElement","className","addEventListener","querySelector","insertAdjacentElement","links","loadedTheme","split","pop","themeToPreload","preload","replace","as","after","console","warn"],"mappings":"AAAA,aAEA,SAASA,2BAA2BC,EAAGC,gBAAkB,IAAIC,GAAuB,oBAAXC,QAA0BH,EAAEG,OAAOC,WAAaJ,EAAE,cAAe,IAAKE,GAAI,CAAE,GAAIG,MAAMC,QAAQN,KAAOE,GAAKK,4BAA4BP,KAAOC,gBAAkBD,GAAyB,iBAAbA,EAAEQ,OAAqB,CAAMN,KAAIF,EAAIE,IAAI,IAAIO,EAAI,EAAOC,EAAI,aAAiB,MAAO,CAAEC,EAAGD,EAAGE,EAAG,WAAe,OAAIH,GAAKT,EAAEQ,OAAe,CAAEK,MAAM,GAAe,CAAEA,MAAM,EAAOC,MAAOd,EAAES,OAAWM,EAAG,SAAWC,IAAM,MAAMA,IAAOC,EAAGP,GAAO,MAAM,IAAIQ,UAAU,yIAA4I,IAA6CC,IAAzCC,kBAAmB,EAAMC,QAAS,EAAY,MAAO,CAAEV,EAAG,WAAeT,GAAKA,GAAGoB,KAAKtB,IAAOY,EAAG,WAAe,IAAIW,KAAOrB,GAAGsB,OAAsC,OAA9BJ,iBAAmBG,KAAKV,KAAaU,MAASR,EAAG,SAAWU,KAAOJ,QAAS,EAAMF,IAAMM,KAAQR,EAAG,WAAe,IAAWG,kBAAoC,MAAhBlB,GAAW,QAAWA,GAAW,SAAO,QAAU,GAAImB,OAAQ,MAAMF,OAE/9B,SAASZ,4BAA4BP,EAAG0B,QAAU,GAAK1B,EAAL,CAAgB,GAAiB,iBAANA,EAAgB,OAAO2B,kBAAkB3B,EAAG0B,QAAS,IAAId,EAAIgB,OAAOC,UAAUC,SAASR,KAAKtB,GAAG+B,MAAM,GAAI,GAAiE,MAAnD,WAANnB,GAAkBZ,EAAEgC,cAAapB,EAAIZ,EAAEgC,YAAYC,MAAgB,QAANrB,GAAqB,QAANA,EAAoBP,MAAM6B,KAAKlC,GAAc,cAANY,GAAqB,2CAA2CuB,KAAKvB,GAAWe,kBAAkB3B,EAAG0B,aAAzG,GAE7S,SAASC,kBAAkBS,IAAKC,MAAkB,MAAPA,KAAeA,IAAMD,IAAI5B,UAAQ6B,IAAMD,IAAI5B,QAAQ,IAAK,IAAIC,EAAI,EAAG6B,KAAO,IAAIjC,MAAMgC,KAAM5B,EAAI4B,IAAK5B,IAAO6B,KAAK7B,GAAK2B,IAAI3B,GAAM,OAAO6B,KANhLC,OAAOC,QAAUD,OAAOC,SAAW,GACnCD,OAAOE,cAAgBF,OAAOE,eAAiB,GAE/C,IAAMC,kBAAoBH,OAAOE,cAAcC,kBAC5CH,OAAOE,cAAcC,kBACrB,CACA,mBACA,oCAOGC,SAAW,SAAUC,KAAMC,KAAMC,OACtC,IAD6CC,MACvCC,OAAS,GAD8BC,UAAAlD,2BAE5BmD,SAASC,iBAAiBP,OAFE,IAI7C,IAAAK,UAAAtC,MAAAoC,MAAAE,UAAArC,KAAAC,MAA6B,CAAA,IAAlBuC,KAAkBL,MAAAjC,MACtBuC,IAAMX,kBAAkBY,SAASC,SAASC,UAC7C,IAAIC,IAAIL,KAAKP,MAAOU,SAASG,QAC7B,IAAID,IAAIL,KAAKP,OAEZC,MAAMX,KAAKkB,IAAIM,WAClBX,OAAOY,KAAKR,OAV+B,MAAAjC,KAAA8B,UAAAlC,EAAAI,KAAA,QAAA8B,UAAAhC,IAc7C,OAAO+B,QAMFa,gBAAkB,SAAUC,QAC5B,CAAC,QAAS,QAAQR,SAASQ,UAASA,OAAS,SAElD,IAHyCC,OAGnCC,cAAgB,IAAIC,OACzB,kDAJwCC,WAAAnE,2BAO3B4C,SAAS,OAAQ,OAAQqB,gBAPE,IASzC,IAAAE,WAAAvD,MAAAoD,OAAAG,WAAAtD,KAAAC,MAA0B,CAAA,IAAfuC,KAAeW,OAAAjD,MACnBuC,IAAMX,kBAAkBY,SAASC,SAASC,UAC7C,IAAIC,IAAIL,KAAKe,KAAMZ,SAASG,QAC5B,IAAID,IAAIL,KAAKe,MAEhB,GAAKzB,kBAAkBY,SAASD,IAAIG,WAEnB,eAAbJ,KAAKgB,IAAsB,CAC9B,IAAMC,IAAMjB,KAAKe,KAAKb,SAAS,QAAU,OAAS,GAClDF,KAAKe,KAAL,GAAAG,OAAejB,IAAIkB,SAAnB,MAAAD,OAAgCjB,IAAIG,SAApC,uBAAAc,OAAkER,QAAlEQ,OAA2ED,IAA3E,UAlBuC,MAAAlD,KAAA+C,WAAAnD,EAAAI,KAAA,QAAA+C,WAAAjD,MA4BW,SAAjDuD,aAAaC,QAAQ,0BAEvBlC,OAAOmC,YACPnC,OAAOmC,WAAW,gCAAgCC,SAElDH,aAAaI,QAAQ,kBAAmB,QACxCJ,aAAaI,QAAQ,uBAAwB,SAE7CJ,aAAaI,QAAQ,kBAAmB,SAO1CrC,OAAOC,QAAQqC,YAAc,SAAUC,WACtC,IAAMC,WACuC,SAA5CP,aAAaC,QAAQ,mBAAgC,QAAU,OAMhE,OAJAZ,gBAAgBkB,YAChBP,aAAaI,QAAQ,kBAAmBG,YACpCD,YAAWA,UAAUE,UAA2B,UAAfD,WAAyB,KAAO,MAE9DA,YAORxC,OAAOC,QAAQyC,eAAiB,WAC/B,IAAMC,YAAcV,aAAaC,QAAQ,mBACnCI,YAAc3B,SAASiC,cAAc,UAC3CN,YAAYG,UAA4B,UAAhBE,YAA0B,KAAO,KACzDL,YAAYO,UAAY,mBACxBP,YAAYQ,iBAAiB,SAAS,WAAA,OACrC9C,OAAOC,QAAQqC,YAAYA,gBAGV3B,SAASoC,cAAc,iBAC/BC,sBAAsB,aAAcV,aAE9C,IAAMb,cAAgB,IAAIC,OACzB,kDAEKuB,MAAQ7C,SAAS,OAAQ,OAAQqB,eAEvC,GAAqB,IAAjBwB,MAAMhF,OAAV,CAOA,IAAMiF,YAC4C,UAAjDD,MAAM,GAAGrB,KAAKuB,MAAM,KAAKC,MAAMD,MAAM,KAAK,GACvC,QACA,OACEE,eAAiC,UAAhBH,YAA0B,OAAS,QAEpDI,QAAU3C,SAASiC,cAAc,QACvCU,QAAQzB,IAAM,aACdyB,QAAQ1B,KAAOqB,MAAM,GAAGrB,KAAK2B,QAAQL,YAAaG,gBAClDC,QAAQE,GAAK,WAEbP,MAAM,GAAGQ,MAAMH,SAEfhC,gBAAgBqB,kBAnBfe,QAAQC,KACP","file":"theme-toggle.js","sourcesContent":["window.furrets = window.furrets || {};\nwindow.USER_OVERRIDE = window.USER_OVERRIDE || {};\n\nconst acceptedHostnames = window.USER_OVERRIDE.acceptedHostnames\n\t? window.USER_OVERRIDE.acceptedHostnames\n\t: [\n\t\t\t'css.furret.codes', // production server\n\t\t\t'furretcss-lib.rayhanadev.repl.co', // development server\n\t  ];\n\n/*\n * @internal\n * Source: {@link https://stackoverflow.com/questions/16791527/can-i-use-a-regular-expression-in-queryselectorall}\n */\nconst DOMRegex = function (elem, attr, regex) {\n\tconst output = [];\n\tconst elements = document.querySelectorAll(elem);\n\n\tfor (const link of elements) {\n\t\tconst url = acceptedHostnames.includes(location.hostname)\n\t\t\t? new URL(link[attr], location.origin) // use website hostname (self-hosting)\n\t\t\t: new URL(link[attr]); // use link hostname (cdn)\n\n\t\tif (regex.test(url.pathname)) {\n\t\t\toutput.push(link);\n\t\t}\n\t}\n\n\treturn output;\n};\n\n/*\n * @internal\n */\nconst loadColorScheme = function (scheme) {\n\tif (!['light', 'dark'].includes(scheme)) scheme = 'light';\n\n\tconst furretcssPath = new RegExp(\n\t\t'/furretcss/v2/full/(?:light|dark)(?:.min)?.css',\n\t);\n\n\tconst links = DOMRegex('link', 'href', furretcssPath);\n\n\tfor (const link of links) {\n\t\tconst url = acceptedHostnames.includes(location.hostname)\n\t\t\t? new URL(link.href, location.origin) // use website hostname (self-hosting)\n\t\t\t: new URL(link.href); // use link hostname (cdn)\n\n\t\tif (!acceptedHostnames.includes(url.hostname)) continue;\n\n\t\tif (link.rel === 'stylesheet') {\n\t\t\tconst min = link.href.includes('.min') ? '.min' : '';\n\t\t\tlink.href = `${url.protocol}//${url.hostname}/furretcss/v2/full/${scheme}${min}.css`;\n\t\t}\n\t}\n};\n\n/*\n * Side effect of loading the file. Sets up first interaction states\n * and sets localStorage keys. Does not activate theme, use\n * furrets.addThemeToggle() to do that.\n */\nif (localStorage.getItem('furretcss-interacted') !== 'true') {\n\tif (\n\t\twindow.matchMedia &&\n\t\twindow.matchMedia('(prefers-color-scheme: dark)').matches\n\t) {\n\t\tlocalStorage.setItem('furretcss-theme', 'dark');\n\t\tlocalStorage.setItem('furretcss-interacted', 'true');\n\t} else {\n\t\tlocalStorage.setItem('furretcss-theme', 'none');\n\t}\n}\n\n/*\n * Function to manually toggle the theme.\n */\nwindow.furrets.themeToggle = function (toggleBtn) {\n\tconst themeToSet =\n\t\tlocalStorage.getItem('furretcss-theme') === 'dark' ? 'light' : 'dark';\n\n\tloadColorScheme(themeToSet);\n\tlocalStorage.setItem('furretcss-theme', themeToSet);\n\tif (toggleBtn) toggleBtn.innerText = themeToSet === 'light' ? '☀️' : '🌙';\n\n\treturn themeToSet;\n};\n\n/*\n * Function to initialize the theme and add a toggle to\n * the website.\n */\nwindow.furrets.addThemeToggle = function () {\n\tconst storedTheme = localStorage.getItem('furretcss-theme');\n\tconst themeToggle = document.createElement('button');\n\tthemeToggle.innerText = storedTheme === 'light' ? '☀️' : '🌙';\n\tthemeToggle.className = 'theme-toggle-btn';\n\tthemeToggle.addEventListener('click', () =>\n\t\twindow.furrets.themeToggle(themeToggle),\n\t);\n\n\tconst container = document.querySelector('div.container');\n\tcontainer.insertAdjacentElement('afterbegin', themeToggle);\n\n\tconst furretcssPath = new RegExp(\n\t\t'/furretcss/v2/full/(?:light|dark)(?:.min)?.css',\n\t);\n\tconst links = DOMRegex('link', 'href', furretcssPath);\n\n\tif (links.length === 0) {\n\t\tconsole.warn(\n\t\t\t'Warning: a full furretcss stylesheet was not found. Cannot choose stylesheet to preload.',\n\t\t);\n\t\treturn;\n\t}\n\n\tconst loadedTheme =\n\t\tlinks[0].href.split('/').pop().split('.')[0] === 'light'\n\t\t\t? 'light'\n\t\t\t: 'dark';\n\tconst themeToPreload = loadedTheme === 'light' ? 'dark' : 'light';\n\n\tconst preload = document.createElement('link');\n\tpreload.rel = 'preconnect';\n\tpreload.href = links[0].href.replace(loadedTheme, themeToPreload);\n\tpreload.as = 'text/css';\n\n\tlinks[0].after(preload);\n\n\tloadColorScheme(storedTheme);\n};\n"]}